'use strict';let getType=(a)=>Object.prototype.toString.call(a),isObject=(a)=>null!==a&&'[object Object]'===getType(a),isArray=(a)=>'[object Array]'===getType(a),isFunction=(a)=>'[object Function]'===getType(a),setImmediate=(a)=>a(),deepCopy=(a)=>{if(isArray(a))return[].slice.call(a);if(!isObject(a))return a;let b={};return Object.keys(a).forEach((d)=>b[d]=deepCopy(a[d])),b},deepEqual=(a,b)=>{if(null===a&&null!==b||null===a&&null!==b)return!1;if(null===a&&null===b)return!0;if(!isObject(a)&&isObject(b)||isObject(a)&&!isObject(b))return!1;if(!isObject(a)&&!isObject(b)&&!isArray(a)&&!isArray(b))return a==b;let d=Object.keys(a);for(let f of d){if(!b.hasOwnProperty(f))return!1;if(!deepEqual(a[f],b[f]))return!1}let e=Object.keys(b);for(let f of e){if(!a.hasOwnProperty(f))return!1;if(!deepEqual(a[f],b[f]))return!1}return!0};class VirtualDOMNode{constructor(a){this.tagName=a,this.attributes={},this.children=[],this.eventListeners={}}appendChild(a){a.parent=this,this.children.push(a)}setAttribute(a,b){!b||(this.attributes[a]=b)}getAttribute(a){return this.attributes[a]}removeChild(a){let b=this.children.indexOf(a);if(0>b)throw'Children not found';this.children=this.children.slice(0,b).concat(b+1,this.children.length)}addEventListener(a,b){this.eventListeners[a]||(this.eventListeners[a]=[]),this.eventListeners[a].push(b)}dispatchEvent(a){a.type&&this.eventListeners[a.type]&&this.eventListeners[a.type].forEach((b)=>b.call(this,a))}removeEventListener(a,b){let d=this.eventListeners[a];if(d){let e=d.indexOf(b);this.eventListeners[a]=d.slice(0,e).concat(d.slice(e,d.length))}}get value(){return this.elt?this.elt.value:void 0}equal(a){return this.elt&&a.elt&&this.elt==a.elt&&('input'==this.tagName&&this.value==a.value||'input'!=this.tagName&&this.innerText==a.innerText)&&deepEqual(this.attributes,a.attributes)&&this.children.every((b,d)=>b.equal(a.children[d]))}applyChanges(a){if(this.equal(a))return;this.elt||this.mount();let{children:b,attributes:d,eventListeners:e,innerText:f}=a;for(let h,g=0;g<b.length;g++){if(h=b[g],g>=this.children.length)this.children.push(h),h.parent=this;else if(this.children[g].equal(h))continue;this.children[g].applyChanges(h)}for(let g=b.length;g<this.children.length;g++)this.children[g].elt&&this.children[g].elt.parentNode==this.elt&&this.elt.removeChild(this.children[g].elt);this.children=this.children.slice(0,b.length),d&&!deepEqual(this.attributes,d)&&(Object.keys(d).forEach((g)=>{let h=d[g];this.attributes[g]==h||(this.attributes[g]=h,this.elt.setAttribute(g,h))}),Object.keys(this.attributes).forEach((g)=>{'undefined'==typeof d[g]&&(delete this.attributes[g],this.elt.removeAttribute(g))})),e&&!deepEqual(this.eventListeners,e)&&(Object.keys(this.eventListeners).forEach((g)=>{this.eventListeners[g].forEach((h)=>{this.elt.removeEventListener(g,h)}),delete this.eventListeners[g]}),Object.keys(e).forEach((g)=>{e[g].forEach((h)=>{this.eventListeners[g]||(this.eventListeners[g]=[]),this.eventListeners[g].push(h),this.elt.addEventListener(g,h)})})),f&&f!=this.innerText&&(this.innerText=f,'input'==this.tagName?this.elt.value=f:this.elt.innerText=f)}mount(a){this.elt=document.createElement(this.tagName),'undefined'!=typeof this.innerText&&null!==this.innerText&&(this.elt.innerText=this.innerText),Object.keys(this.attributes).forEach((b)=>this.elt.setAttribute(b,this.attributes[b])),Object.keys(this.eventListeners).forEach((b)=>{this.eventListeners[b].forEach((d)=>this.elt.addEventListener(b,d,!1))}),setImmediate(()=>{this.children.filter((d)=>!d.elt).forEach((d)=>d.mount(this.elt))}),this.parent&&this.parent.elt?this.parent.elt.appendChild(this.elt):a&&a.appendChild(this.elt)}unmount(){this.elt&&this.elt.parentNode.removeChild(this.elt)}}let c=function(a,b,d){let e,h,f=[],g={};return isFunction(a)?a.apply(null,[].slice.apply(arguments).slice(1)):(isArray(b)?f=b.slice():isObject(b)?(g=b,isArray(d)?f=d.slice():h=d):h=b,e=new VirtualDOMNode(a),Object.keys(g).forEach((i)=>{let j=g[i];isFunction(j)?e.addEventListener(i,j):e.setAttribute(i,j)}),f.forEach((i)=>{'undefined'==typeof i||null==i||VirtualDOMNode.prototype.isPrototypeOf(i)&&e.appendChild(i)}),e.innerText=h,e)},connectToStore=(a,b)=>{let d=()=>a.call(null,b),e=d();return b.onStateChanged(()=>e.applyChanges(d())),e};class Store{constructor(a){this.state=deepCopy(a),this.listeners=[],this.reducers=[]}static createStore(a){return new Store(a)}getState(){return deepCopy(this.state)}onAction(a){this.reducers.push(a)}onStateChanged(a){this.listeners.push(a)}dispatch(a){setImmediate(()=>{let d=deepCopy(this.state),e=this.reducers.reduce((f,g)=>g.call(null,f,a),this.state);deepEqual(e,d)||(this.state=e,this.listeners.forEach((f)=>f.call(null,e,d)))})}}const exportsObj={createStore:Store.createStore,c,connectToStore};'object'==typeof module&&null!=module&&module.exports?Object.assign(module,{exports:exportsObj}):'object'==typeof exports&&null!=exports?Object.assign(exports,{libc:exportsObj}):'undefined'!=typeof window&&Object.assign(window,exportsObj);
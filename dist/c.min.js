"use strict";function _classCallCheck(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}var _typeof="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},_createClass=function(){function t(t,e){for(var n=0;n<e.length;n++){var i=e[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(t,i.key,i)}}return function(e,n,i){return n&&t(e.prototype,n),i&&t(e,i),e}}();!function(){var t=function(t){return Object.prototype.toString.call(t)},e=function(e){return null!==e&&"[object Object]"===t(e)},n=function(e){return"[object Array]"===t(e)},i=function(e){return"[object Function]"===t(e)},r=function t(e){return e.reduce(function(e,i){return e.concat(n(i)?t(i):[i])},[])},u=function(t){return setTimeout(t,0)},s=function t(i){if(n(i))return[].slice.call(i);if(!e(i))return i;var r={};return Object.keys(i).forEach(function(e){return r[e]=t(i[e])}),r},l=function t(i,r){if(null===i&&null!==r||null===i&&null!==r)return!1;if(null===i&&null===r)return!0;if(!e(i)&&e(r)||e(i)&&!e(r))return!1;if(!(e(i)||e(r)||n(i)||n(r)))return i==r;var u=Object.keys(i),s=!0,l=!1,a=void 0;try{for(var o,c=u[Symbol.iterator]();!(s=(o=c.next()).done);s=!0){var h=o.value;if(!r.hasOwnProperty(h))return!1;if(!t(i[h],r[h]))return!1}}catch(t){l=!0,a=t}finally{try{!s&&c.return&&c.return()}finally{if(l)throw a}}var f=Object.keys(r),d=!0,v=!1,y=void 0;try{for(var p,b=f[Symbol.iterator]();!(d=(p=b.next()).done);d=!0){var k=p.value;if(!i.hasOwnProperty(k))return!1;if(!t(i[k],r[k]))return!1}}catch(t){v=!0,y=t}finally{try{!d&&b.return&&b.return()}finally{if(v)throw y}}return!0},a=function(t){return o.prototype.isPrototypeOf(t)},o=function(){function t(e,n,i,r){_classCallCheck(this,t),this.tagName=e,this.attributes=n||{},this.children=i||[],this.innerText=r||null,this.parent=null,this.elt=null,this.eventListeners={}}return _createClass(t,[{key:"appendChild",value:function(t){t.parent=this,this.children.push(t)}},{key:"setAttribute",value:function(t,e){this.attributes[t]=e}},{key:"getAttribute",value:function(t){return this.attributes[t]}},{key:"removeChild",value:function(t){var e=this.children.indexOf(t);if(e<0)throw"Children not found";this.children=this.children.slice(0,e).concat(e+1,this.children.length)}},{key:"addEventListener",value:function(t,e){this.eventListeners[t]||(this.eventListeners[t]=[]),this.eventListeners[t].push(e)}},{key:"dispatchEvent",value:function(t){var e=this;t.type&&this.eventListeners[t.type]&&this.eventListeners[t.type].forEach(function(n){return n.call(e,t)})}},{key:"removeEventListener",value:function(t,e){var n=this.eventListeners[t];if(n){var i=n.indexOf(e);this.eventListeners[t]=n.slice(0,i).concat(n.slice(i,n.length))}}},{key:"equal",value:function(t){return this.elt&&t.elt&&this.elt==t.elt&&this.text==t.text&&l(this.attributes,t.attributes)&&this.children.every(function(e,n){return e.equal(t.children[n])})}},{key:"applyChanges",value:function(t){var e=this;this.elt||this.materialize();var n=[t.children,t.attributes,t.innerText],i=n[0],r=n[1],u=n[2];i.forEach(function(t,n){if(n>=e.children.length)e.children.push(t);else if(e.children[n].equal(t))return;e.children[n].applyChanges(t)}),r&&!l(this.attributes,r)&&(Object.keys(r).forEach(function(t){var n=r[t];e.attributes[t]!=n&&(e.attributes[t]=n,e.elt.setAttribute(t,n))}),Object.keys(this.attributes).forEach(function(t){"undefined"==typeof r[t]&&(delete e.attributes[t],e.elt.removeAttribute(t))})),u&&u!=this.innerText&&(this.innerText=u,this.elt.innerText=u)}},{key:"materialize",value:function(t){var e=this;this.elt=document.createElement(this.tagName),"undefined"!=typeof this.innerText&&null!==this.innerText&&(this.elt.innerText=this.innerText),Object.keys(this.attributes).forEach(function(t){return e.elt.setAttribute(t,e.attributes[t])}),Object.keys(this.eventListeners).forEach(function(t){e.eventListeners[t].forEach(function(n){return e.elt.addEventListener(t,n.bind(e.elt))})}),u(function(t){e.children.forEach(function(t){return t.materialize(e.elt)})}),this.parent&&this.parent.elt?this.parent.elt.appendChild(this.elt):t&&t.appendChild(this.elt)}}]),t}(),c=function(){function t(u,s,l){_classCallCheck(this,t);var c=void 0,h=void 0,f=void 0;n(s)?c=s.slice():e(s)?(h=s,c=n(l)?l.slice():[l]):c=[s],c=c?r(c):[],h=h||{},f=new o(u),Object.keys(h).forEach(function(t){var e=h[t];i(e)?f.addEventListener(t,e):f.setAttribute(t,e)}),c.forEach(function(e){"undefined"!=typeof e&&null!=e&&(a(e)?f.appendChild(e):e instanceof t?f.appendChild(e.elt):f.innerText=e)}),this.elt=f}return _createClass(t,[{key:"mount",value:function(t){this.elt.materialize(t)}},{key:"unmount",value:function(){this.elt.parentElement.removeChild(this.elt)}},{key:"on",value:function(t,e,n){this.elt.addEventListener(t,e.bind(this),n)}},{key:"fire",value:function(t){var e=new Event(t,[].slice.apply(arguments,1));this.elt.dispatchEvent(e)}}]),t}(),h=function(t,e,n){return new c(t,e,n)},f=function(){function t(e){_classCallCheck(this,t),this.state=s(e),this.listener=function(){return null},this.reducer=function(t,e){return t}}return _createClass(t,[{key:"getState",value:function(){return s(this.state)}},{key:"onAction",value:function(t){this.reducer=t}},{key:"onStateChanged",value:function(t){this.listener=t}},{key:"dispatch",value:function(t){var e=this;u(function(n){var i=s(e.state),r=e.reducer(e.state,t);l(r,i)||(e.state=r,e.listener(r,i))})}}],[{key:"createStore",value:function(e){return new t(e)}}]),t}(),d=function(){function t(e,n,i){_classCallCheck(this,t),this.store=new f(e),this.updateFn=n,this.viewFn=i,this.view=null,this.store.onAction(this._onAction.bind(this)),this.store.onStateChanged(this._onStateChanged.bind(this))}return _createClass(t,[{key:"mount",value:function(t){this.view=this.viewFn.call(null,this.store.getState(),this.dispatch.bind(this)),this.view.elt.materialize(t)}},{key:"dispatch",value:function(t){this.store.dispatch(t)}},{key:"_onAction",value:function(t,e){return this.updateFn.call(null,t,e)}},{key:"_onStateChanged",value:function(t){var e=this.viewFn.call(null,t,this.dispatch.bind(this));this.view.elt.applyChanges(e.elt)}}]),t}(),v=function(t,e,n){return new d(t,e,n)};"undefined"!=typeof window?(window.c=h,window.createApplication=v):"object"===("undefined"==typeof module?"undefined":_typeof(module))&&null!=module&&module.exports&&(module.exports={c:h,createApplication:v})}();
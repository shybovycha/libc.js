'use strict';var _typeof='function'==typeof Symbol&&'symbol'==typeof Symbol.iterator?function(a){return typeof a}:function(a){return a&&'function'==typeof Symbol&&a.constructor===Symbol&&a!==Symbol.prototype?'symbol':typeof a},_createClass=function(){function a(b,d){for(var f,e=0;e<d.length;e++)f=d[e],f.enumerable=f.enumerable||!1,f.configurable=!0,'value'in f&&(f.writable=!0),Object.defineProperty(b,f.key,f)}return function(b,d,e){return d&&a(b.prototype,d),e&&a(b,e),b}}();function _classCallCheck(a,b){if(!(a instanceof b))throw new TypeError('Cannot call a class as a function')}(function(){'use strict';var a=function getType(q){return Object.prototype.toString.call(q)},b=function isObject(q){return null!==q&&'[object Object]'===a(q)},d=function isArray(q){return'[object Array]'===a(q)},e=function isFunction(q){return'[object Function]'===a(q)},f=function setImmediate(q){return setTimeout(q,0)},g=function deepCopy(q){if(d(q))return[].slice.call(q);if(!b(q))return q;var r={};return Object.keys(q).forEach(function(s){return r[s]=g(q[s])}),r},h=function deepEqual(q,r){if(null===q&&null!==r||null===q&&null!==r)return!1;if(null===q&&null===r)return!0;if(!b(q)&&b(r)||b(q)&&!b(r))return!1;if(!b(q)&&!b(r)&&!d(q)&&!d(r))return q==r;var s=Object.keys(q),t=!0,u=!1,v=void 0;try{for(var x,E,w=s[Symbol.iterator]();!(t=(x=w.next()).done);t=!0){if(E=x.value,!r.hasOwnProperty(E))return!1;if(!h(q[E],r[E]))return!1}}catch(E){u=!0,v=E}finally{try{!t&&w.return&&w.return()}finally{if(u)throw v}}var y=Object.keys(r),z=!0,A=!1,B=void 0;try{for(var D,E,C=y[Symbol.iterator]();!(z=(D=C.next()).done);z=!0){if(E=D.value,!q.hasOwnProperty(E))return!1;if(!h(q[E],r[E]))return!1}}catch(E){A=!0,B=E}finally{try{!z&&C.return&&C.return()}finally{if(A)throw B}}return!0},j=function isDOM(q){return l.prototype.isPrototypeOf(q)},l=function(){function q(r,s,t,u){_classCallCheck(this,q),this.tagName=r,this.attributes=s||{},this.children=t||[],this.innerText=u||null,this.parent=null,this.elt=null,this.eventListeners={}}return _createClass(q,[{key:'appendChild',value:function appendChild(r){r.parent=this,this.children.push(r)}},{key:'setAttribute',value:function setAttribute(r,s){this.attributes[r]=s}},{key:'getAttribute',value:function getAttribute(r){return this.attributes[r]}},{key:'removeChild',value:function removeChild(r){var s=this.children.indexOf(r);if(0>s)throw'Children not found';this.children=this.children.slice(0,s).concat(s+1,this.children.length)}},{key:'addEventListener',value:function addEventListener(r,s){this.eventListeners[r]||(this.eventListeners[r]=[]),this.eventListeners[r].push(s)}},{key:'dispatchEvent',value:function dispatchEvent(r){var s=this;r.type&&this.eventListeners[r.type]&&this.eventListeners[r.type].forEach(function(t){return t.call(s,r)})}},{key:'removeEventListener',value:function removeEventListener(r,s){var t=this.eventListeners[r];if(t){var u=t.indexOf(s);this.eventListeners[r]=t.slice(0,u).concat(t.slice(u,t.length))}}},{key:'equal',value:function equal(r){return this.elt&&r.elt&&this.elt==r.elt&&this.text==r.text&&h(this.attributes,r.attributes)&&this.children.every(function(s,t){return s.equal(r.children[t])})}},{key:'applyChanges',value:function applyChanges(r){var s=this;this.elt||this.materialize();var t=[r.children,r.attributes,r.innerText],u=t[0],v=t[1],w=t[2];u.forEach(function(x,y){if(y>=s.children.length)s.children.push(x);else if(s.children[y].equal(x))return;s.children[y].applyChanges(x)}),v&&!h(this.attributes,v)&&(Object.keys(v).forEach(function(x){var y=v[x];s.attributes[x]==y||(s.attributes[x]=y,s.elt.setAttribute(x,y))}),Object.keys(this.attributes).forEach(function(x){'undefined'==typeof v[x]&&(delete s.attributes[x],s.elt.removeAttribute(x))})),w&&w!=this.innerText&&(this.innerText=w,this.elt.innerText=w)}},{key:'materialize',value:function materialize(r){var s=this;this.elt=document.createElement(this.tagName),'undefined'!=typeof this.innerText&&null!==this.innerText&&(this.elt.innerText=this.innerText),Object.keys(this.attributes).forEach(function(t){return s.elt.setAttribute(t,s.attributes[t])}),Object.keys(this.eventListeners).forEach(function(t){s.eventListeners[t].forEach(function(u){return s.elt.addEventListener(t,u.bind(s.elt))})}),f(function(){s.children.forEach(function(u){return u.materialize(s.elt)})}),this.parent&&this.parent.elt?this.parent.elt.appendChild(this.elt):r&&r.appendChild(this.elt)}}]),q}(),m=function c(q,r,s){var t,u,v;return d(r)?t=r.slice():b(r)?(u=r,t=d(s)?s.slice():[s]):t=[r],t=t||[],u=u||{},v=new l(q),Object.keys(u).forEach(function(w){var x=u[w];e(x)?v.addEventListener(w,x):v.setAttribute(w,x)}),t.forEach(function(w){'undefined'==typeof w||null==w||(j(w)?v.appendChild(w):v.innerText=w)}),v},n=function(){function q(r){_classCallCheck(this,q),this.state=g(r),this.listener=function(){return null},this.reducer=function(s){return s}}return _createClass(q,[{key:'getState',value:function getState(){return g(this.state)}},{key:'onAction',value:function onAction(r){this.reducer=r}},{key:'onStateChanged',value:function onStateChanged(r){this.listener=r}},{key:'dispatch',value:function dispatch(r){var s=this;f(function(){var u=g(s.state),v=s.reducer(s.state,r);h(v,u)||(s.state=v,s.listener(v,u))})}}],[{key:'createStore',value:function createStore(r){return new q(r)}}]),q}(),o=function(){function q(r,s,t){_classCallCheck(this,q),this.store=new n(r),this.updateFn=s,this.viewFn=t,this.view=null,this.store.onAction(this._onAction.bind(this)),this.store.onStateChanged(this._onStateChanged.bind(this))}return _createClass(q,[{key:'mount',value:function mount(r){this.view=this.viewFn.call(null,this.store.getState(),this.dispatch.bind(this)),this.view.materialize(r)}},{key:'dispatch',value:function dispatch(r){this.store.dispatch(r)}},{key:'_onAction',value:function _onAction(r,s){return this.updateFn.call(null,r,s)}},{key:'_onStateChanged',value:function _onStateChanged(r){var s=this.viewFn.call(null,r,this.dispatch.bind(this));this.view.applyChanges(s)}}]),q}(),p=function createApplication(q,r,s){return new o(q,r,s)};'undefined'==typeof window?'object'===('undefined'==typeof module?'undefined':_typeof(module))&&null!=module&&module.exports&&(module.exports={c:m,createApplication:p}):(window.c=m,window.createApplication=p)})();